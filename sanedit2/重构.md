我需要重构一个python项目,主要功能是三国志8R的自建武将修改器
现在使用的是tkinter
核心功能是读取特定文件，转码成字符串，然后置入界面，以列表形式让用户修改
主程序

```py
import tkinter as tk
from tkinter import ttk
from encode import encode
import os, binascii
from tkinter import font
# pyinstaller --onefile --hidden-import=encode --hidden-import=personsave_edit main.py
# 定义bin文件目录
path = os.path.join(os.environ['USERPROFILE'], 'Documents',  'KoeiTecmo', 'SAN8R', 'SAVE_DATA','edit_personSC.bin')
if not os.path.exists(path):
    raise FileNotFoundError(f"路径不存在：{path}")
ec=encode()
warriors=None  
def warriorsload():
    ec.warriors = ec.decode_bin_file(path)
def create_main_window():    
    root = tk.Tk()
    root.title("三国志8RE自建武将修改器")  
    root.geometry("1280x640")
    warriorsload()    
    warriors=ec.warriors 
    # 创建菜单栏
    menubar = tk.Menu(root)
    file_menu = tk.Menu(menubar, tearoff=0)
    file_menu.add_command(label="重新加载", command=warriorsload)
    menubar.add_cascade(label="文件", menu=file_menu)
    root.config(menu=menubar)   
    return root

if __name__ == "__main__":    
    window = create_main_window()
    window.mainloop()
```


以下是读取武将信息的方法，我放在encode.py里面
```py
def decode_bin_file(self, path):
    with open(path, 'rb') as file:
        hex_string = binascii.hexlify(file.read()).decode('utf-8')
    warriors = []
    lenth =len(hex_string)/2294
    for i in range(0,int(lenth)):
        warrior_start = i*2294
        try:
            warrior_data=self.warrior_read(warrior_start,hex_string)        
            warriors.append(warrior_data)
        except Exception as ex:
            print(ex)
    return warriors
```

当然encode 里面有个单独读取武将的方法 warrior_read 这个暂时不需要你去考虑，他是将hex_string 转换为字典方便使用
还有一个关键的东西放在encode.py里
```py
self.properties_savedata = {
    "idx": {
        "positions": [0, 4],
        "column_widths": 100,
        "trl": "编号"
    },
    "surname": {
        "positions": [8, 8],
        "column_widths": 100,
        "trl": "姓"
    }  
    # 此处省略其他属性
}
```
这样我就可以根据属性，到主程序创建表格，把每个武将的属性列出来允许修改了

现在要做的事情：
1. 根据属性创建列表到主界面，展示的时候我期望列名按照trl显示中文，还不能够修改完之后要正确的保存到warriors这个变量里，双击进入修改，按回车进行保存，根据文本长度自动调整列宽

请用中文简要回复


接下来放置一个按钮，将变量warriors保存到文件，方法是
```py
ec.save_to_bin_file(warriors, path)
```
另外菜单里不是有个重新加载的按钮么，这个功能执行后需要刷新页面重新加载到表格

简要中文回复，如果可能，不要给全部的代码，只给出你修改的部分





现在保存会给我把第一个改炸
